name: Doxygen GitHub Pages Deploy Action

on: [push, pull_request, workflow_dispatch]

jobs:
    deploy:
        permissions:
            contents: write
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v2
            - name: Install Doxygen and Graphviz
              run: sudo apt-get update && sudo apt-get install -y doxygen graphviz
            - name: Generate Doxygen documentation
              run: doxygen Doxyfile
            - name: Create .nojekyll file
              run: touch docs/html/.nojekyll
            - name: Add Doxygen Awesome CSS submodule
              run: cd docs/html && git submodule add -f https://github.com/jothepro/doxygen-awesome-css.git
            - name: Deploy to GitHub Pages
              uses: JamesIves/github-pages-deploy-action@4.1.4
              with:
                branch: gh-pages
                folder: docs/html/
                token: ${{ secrets.GITHUB_TOKEN }}
                clean: true

# jobs:
#   deploy:
#     permissions:
#         contents: write
#     runs-on: ubuntu-latest
#     steps:
#       - name: Checkout repository
#         uses: actions/checkout@v2
#       - uses: DenverCoder1/doxygen-github-pages-action@v1.3.0
#         with:
#           github_token: ${{ secrets.GITHUB_TOKEN }}
#       - name: Add Doxygen Awesome CSS submodule
#         run: git submodule add -f https://github.com/jothepro/doxygen-awesome-css.git && cd doxygen-awesome-css && git checkout v2.3.3
#       - name: Deploy to GitHub Pages
#         uses: JamesIves/github-pages-deploy-action@v4.6.1
#         with:
#           folder: docs/html